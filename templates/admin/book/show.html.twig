{% extends 'base.html.twig' %}
{% block body_id 'book_show' %}

{% block main %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-lg rounded-4 overflow-hidden">
                {% if book.coverImage %}
                    <img src="{{ asset('uploads/covers/' ~ book.coverImage) }}" class="w-100 object-fit-cover" style="max-height: 300px;" alt="{{ book.title }}">
                {% else %}
                    <img src="{{ asset('images/default-book.jpg') }}" class="w-100 object-fit-cover" style="max-height: 300px;" alt="Livre">
                {% endif %}

                <div class="card-body p-4">
                    <h2 class="h4 mb-2">{{ book.title }}</h2>
                    <p class="text-muted mb-1">‚úçÔ∏è {{ book.author }}</p>

                    <span class="badge 
                        {% if book.available %}
                            bg-success
                        {% else %}
                            bg-secondary
                        {% endif %}
                    ">
                        {{ book.available ? 'Disponible pour √©change' : 'Indisponible' }}
                    </span>

                    {% if book.description %}
                        <hr>
                        <p class="mt-3">{{ book.description }}</p>
                    {% endif %}

                    <hr>
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="text-muted small">
                            Ajout√© le {{ book.createdAt|date('d/m/Y') }}
                        </div>

                        {% if app.user and app.user.id != book.owner.id %}
                            <a href="{{ path('start_conversation', {id: book.owner.id}) }}" class="btn btn-primary rounded-pill">
                                üí¨ Proposer un √©change
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>

            {% if app.user and app.user.id == book.owner.id %}
                <div class="text-end mt-3">
                    <a href="{{ path('book_edit', {id: book.id}) }}" class="btn btn-outline-secondary rounded-pill me-2">‚úèÔ∏è Modifier</a>
                    <form method="POST" action="{{ path('book_delete', {id: book.id}) }}" class="d-inline-block" onsubmit="return confirm('Supprimer ce livre ?')">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ book.id) }}">
                        <button class="btn btn-outline-danger rounded-pill">üóëÔ∏è Supprimer</button>
                    </form>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
